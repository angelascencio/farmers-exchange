<section id="add" class="container">
    <div class="form-wrap">
        <h1>Add An Item</h1>
        {{#each errors}}
            <div class="error">
                <p>{{text}}</p>
            </div>
        {{/each}}

        <form action="/api/listings/new" method="POST">
            <div class="input-group">
                <label for="title">Title</label>
                <input type="text" name="product_name" id="title" class="input-box" placeholder="eg. Small Wordpress website, React developer" maxlength="100" value={{title}}>
            </div>
            <div class="input-group">
                <label for="price">Price</label>
                <input type="number" name="price" id="price" class="input-box" placeholder="eg. 5, 50, 100" value={{price}}>
            </div>
            <div class="input-group">
                <label for="unit">Unit</label>
                <textarea name="unit" id="unit" class="input-box" placeholder="Describe the details of the item" rows="10" ={{description}}></textarea>
            </div>
            <div class="input-group">
                <label for="description">Description</label>
                <textarea name="description" id="description" class="input-box" placeholder="Describe the details of the item" rows="10" ={{description}}></textarea>
            </div>
            <div class="input-group">
                <label for="stock">stock</label>
                <textarea name="stock" id="stock" class="input-box" placeholder="Describe the details of the item" rows="10" ={{description}}></textarea>
            </div>
            {{!-- <div class="input-group">
                <label for="contact_email">Contact Email</label>
                <input type="email" name="contact_email" id="contactemail" class="input-box" placeholder="Enter an email">
            </div> --}}
            <div class="input-group">
                <label for="image_url">Image Url</label>
                <input type="text" name="image_url" id="image_url" class="input-box" placeholder="enter a url">
            </div>


            <button id="upload_widget" class="cloudinary-button">Upload files</button>

            <script src="https://upload-widget.cloudinary.com/global/all.js" type="text/javascript"></script>

            <script type="text/javascript">
                var myWidget = cloudinary.createUploadWidget({
                    cloudName: 'ucla-coding-bootcamp',
                    uploadPreset: 'vdp2eqbe'
                }, (error, result) => {
                    if (!error && result && result.event === "success") {
                        console.log('Done! Here is the image info: ', result.info.secure_url);
                        const image_url = result.info.secure_url;
                        document.querySelector("#image_url").setAttribute("value", image_url);
                    }
                })

                document.getElementById("upload_widget").addEventListener("click", function (event) {
                    event.preventDefault()
                    myWidget.open();
                }, false);
            </script>

            <input type="submit" ="Add Item" class="btn btn-reverse">
        </form>
    </div>
</section>
